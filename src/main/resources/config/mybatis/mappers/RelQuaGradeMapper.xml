<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.silita.dao.RelQuaGradeMapper" >

    <select id="queryQuaGrade" parameterType="java.util.Map" resultType="com.silita.model.RelQuaGrade">
        select t.id as id
                ,t1.name as `name`
                ,`code` as gradeCode
                ,t1.id as gradeId
        from rel_qua_grade t
        left join dic_common t1 on t.grade_code = t1.code and `type`  = 'qua_grade'
        where 1=1
        <if test="quaCode != null and quaCode != ''">
            and t.qua_code = #{quaCode}
        </if>
        and (t.biz_type = '0' or t.biz_type = #{bizType})
    </select>

    <insert id="insertQuaCrade" parameterType="com.silita.model.RelQuaGrade">
        INSERT INTO `rel_qua_grade`(`id`,`qua_code`,`grade_type`,`biz_type`,`grade_code`)
        VALUES (#{id},#{quaCode},#{gradeType},#{bizType},#{gradeCode})
    </insert>

    <delete id="delQuaCrade" parameterType="java.util.Map">
        DELETE FROM `rel_qua_grade` WHERE `id` = #{id}
    </delete>

    <select id="queryQuaGradeCout" parameterType="com.silita.model.RelQuaGrade" resultType="java.lang.Integer">
        select count(1)
        from rel_qua_grade
        where 1=1
        and qua_code = #{quaCode}
        and grade_code = #{gradeCode}
        and biz_type = #{bizType}
    </select>

    <select id="quaryGradeCountByCode" resultType="java.lang.Integer" parameterType="java.lang.String">
        select count(1)
        from rel_qua_grade
        where 1=1
        and grade_code = #{gradeCode}
    </select>
</mapper>